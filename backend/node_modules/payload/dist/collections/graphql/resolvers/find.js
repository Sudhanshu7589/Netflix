/* eslint-disable no-param-reassign */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return findResolver;
    }
});
const _isolateObjectProperty = /*#__PURE__*/ _interop_require_default(require("../../../utilities/isolateObjectProperty"));
const _find = /*#__PURE__*/ _interop_require_default(require("../../operations/find"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function findResolver(collection) {
    return async function resolver(_, args, context) {
        let { req } = context;
        const locale = req.locale;
        const fallbackLocale = req.fallbackLocale;
        req = (0, _isolateObjectProperty.default)(req, 'locale');
        req = (0, _isolateObjectProperty.default)(req, 'fallbackLocale');
        req.locale = args.locale || locale;
        req.fallbackLocale = args.fallbackLocale || fallbackLocale;
        if (!req.query) req.query = {};
        const draft = args.draft ?? req.query?.draft === 'false' ? false : req.query?.draft === 'true' ? true : undefined;
        if (typeof draft === 'boolean') req.query.draft = String(draft);
        context.req = req;
        const options = {
            collection,
            depth: 0,
            draft: args.draft,
            limit: args.limit,
            page: args.page,
            req: (0, _isolateObjectProperty.default)(req, 'transactionID'),
            sort: args.sort,
            where: args.where
        };
        const results = await (0, _find.default)(options);
        return results;
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb2xsZWN0aW9ucy9ncmFwaHFsL3Jlc29sdmVycy9maW5kLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG5pbXBvcnQgdHlwZSB7IFBhZ2luYXRlZERvY3MgfSBmcm9tICcuLi8uLi8uLi9kYXRhYmFzZS90eXBlcydcbmltcG9ydCB0eXBlIHsgUGF5bG9hZFJlcXVlc3QgfSBmcm9tICcuLi8uLi8uLi9leHByZXNzL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBXaGVyZSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29uZmlnL3R5cGVzJ1xuXG5pbXBvcnQgaXNvbGF0ZU9iamVjdFByb3BlcnR5IGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9pc29sYXRlT2JqZWN0UHJvcGVydHknXG5pbXBvcnQgZmluZCBmcm9tICcuLi8uLi9vcGVyYXRpb25zL2ZpbmQnXG5cbmV4cG9ydCB0eXBlIFJlc29sdmVyID0gKFxuICBfOiB1bmtub3duLFxuICBhcmdzOiB7XG4gICAgZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgICBkcmFmdDogYm9vbGVhblxuICAgIGZhbGxiYWNrTG9jYWxlPzogc3RyaW5nXG4gICAgbGltaXQ/OiBudW1iZXJcbiAgICBsb2NhbGU/OiBzdHJpbmdcbiAgICBwYWdlPzogbnVtYmVyXG4gICAgc29ydD86IHN0cmluZ1xuICAgIHdoZXJlPzogV2hlcmVcbiAgfSxcbiAgY29udGV4dDoge1xuICAgIHJlcTogUGF5bG9hZFJlcXVlc3RcbiAgICByZXM6IFJlc3BvbnNlXG4gIH0sXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4pID0+IFByb21pc2U8UGFnaW5hdGVkRG9jczxhbnk+PlxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBmaW5kUmVzb2x2ZXIoY29sbGVjdGlvbjogQ29sbGVjdGlvbik6IFJlc29sdmVyIHtcbiAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uIHJlc29sdmVyKF8sIGFyZ3MsIGNvbnRleHQpIHtcbiAgICBsZXQgeyByZXEgfSA9IGNvbnRleHRcbiAgICBjb25zdCBsb2NhbGUgPSByZXEubG9jYWxlXG4gICAgY29uc3QgZmFsbGJhY2tMb2NhbGUgPSByZXEuZmFsbGJhY2tMb2NhbGVcbiAgICByZXEgPSBpc29sYXRlT2JqZWN0UHJvcGVydHkocmVxLCAnbG9jYWxlJylcbiAgICByZXEgPSBpc29sYXRlT2JqZWN0UHJvcGVydHkocmVxLCAnZmFsbGJhY2tMb2NhbGUnKVxuICAgIHJlcS5sb2NhbGUgPSBhcmdzLmxvY2FsZSB8fCBsb2NhbGVcbiAgICByZXEuZmFsbGJhY2tMb2NhbGUgPSBhcmdzLmZhbGxiYWNrTG9jYWxlIHx8IGZhbGxiYWNrTG9jYWxlXG4gICAgaWYgKCFyZXEucXVlcnkpIHJlcS5xdWVyeSA9IHt9XG5cbiAgICBjb25zdCBkcmFmdDogYm9vbGVhbiA9XG4gICAgICBhcmdzLmRyYWZ0ID8/IHJlcS5xdWVyeT8uZHJhZnQgPT09ICdmYWxzZSdcbiAgICAgICAgPyBmYWxzZVxuICAgICAgICA6IHJlcS5xdWVyeT8uZHJhZnQgPT09ICd0cnVlJ1xuICAgICAgICA/IHRydWVcbiAgICAgICAgOiB1bmRlZmluZWRcbiAgICBpZiAodHlwZW9mIGRyYWZ0ID09PSAnYm9vbGVhbicpIHJlcS5xdWVyeS5kcmFmdCA9IFN0cmluZyhkcmFmdClcblxuICAgIGNvbnRleHQucmVxID0gcmVxXG5cbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgY29sbGVjdGlvbixcbiAgICAgIGRlcHRoOiAwLFxuICAgICAgZHJhZnQ6IGFyZ3MuZHJhZnQsXG4gICAgICBsaW1pdDogYXJncy5saW1pdCxcbiAgICAgIHBhZ2U6IGFyZ3MucGFnZSxcbiAgICAgIHJlcTogaXNvbGF0ZU9iamVjdFByb3BlcnR5PFBheWxvYWRSZXF1ZXN0PihyZXEsICd0cmFuc2FjdGlvbklEJyksXG4gICAgICBzb3J0OiBhcmdzLnNvcnQsXG4gICAgICB3aGVyZTogYXJncy53aGVyZSxcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZmluZChvcHRpb25zKVxuICAgIHJldHVybiByZXN1bHRzXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmaW5kUmVzb2x2ZXIiLCJjb2xsZWN0aW9uIiwicmVzb2x2ZXIiLCJfIiwiYXJncyIsImNvbnRleHQiLCJyZXEiLCJsb2NhbGUiLCJmYWxsYmFja0xvY2FsZSIsImlzb2xhdGVPYmplY3RQcm9wZXJ0eSIsInF1ZXJ5IiwiZHJhZnQiLCJ1bmRlZmluZWQiLCJTdHJpbmciLCJvcHRpb25zIiwiZGVwdGgiLCJsaW1pdCIsInBhZ2UiLCJzb3J0Iiwid2hlcmUiLCJyZXN1bHRzIiwiZmluZCJdLCJtYXBwaW5ncyI6IkFBQUEsb0NBQW9DOzs7OytCQTRCcEM7OztlQUF3QkE7Ozs4RUF0QlU7NkRBQ2pCOzs7Ozs7QUFxQkYsU0FBU0EsYUFBYUMsVUFBc0I7SUFDekQsT0FBTyxlQUFlQyxTQUFTQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsT0FBTztRQUM3QyxJQUFJLEVBQUVDLEdBQUcsRUFBRSxHQUFHRDtRQUNkLE1BQU1FLFNBQVNELElBQUlDLE1BQU07UUFDekIsTUFBTUMsaUJBQWlCRixJQUFJRSxjQUFjO1FBQ3pDRixNQUFNRyxJQUFBQSw4QkFBcUIsRUFBQ0gsS0FBSztRQUNqQ0EsTUFBTUcsSUFBQUEsOEJBQXFCLEVBQUNILEtBQUs7UUFDakNBLElBQUlDLE1BQU0sR0FBR0gsS0FBS0csTUFBTSxJQUFJQTtRQUM1QkQsSUFBSUUsY0FBYyxHQUFHSixLQUFLSSxjQUFjLElBQUlBO1FBQzVDLElBQUksQ0FBQ0YsSUFBSUksS0FBSyxFQUFFSixJQUFJSSxLQUFLLEdBQUcsQ0FBQztRQUU3QixNQUFNQyxRQUNKUCxLQUFLTyxLQUFLLElBQUlMLElBQUlJLEtBQUssRUFBRUMsVUFBVSxVQUMvQixRQUNBTCxJQUFJSSxLQUFLLEVBQUVDLFVBQVUsU0FDckIsT0FDQUM7UUFDTixJQUFJLE9BQU9ELFVBQVUsV0FBV0wsSUFBSUksS0FBSyxDQUFDQyxLQUFLLEdBQUdFLE9BQU9GO1FBRXpETixRQUFRQyxHQUFHLEdBQUdBO1FBRWQsTUFBTVEsVUFBVTtZQUNkYjtZQUNBYyxPQUFPO1lBQ1BKLE9BQU9QLEtBQUtPLEtBQUs7WUFDakJLLE9BQU9aLEtBQUtZLEtBQUs7WUFDakJDLE1BQU1iLEtBQUthLElBQUk7WUFDZlgsS0FBS0csSUFBQUEsOEJBQXFCLEVBQWlCSCxLQUFLO1lBQ2hEWSxNQUFNZCxLQUFLYyxJQUFJO1lBQ2ZDLE9BQU9mLEtBQUtlLEtBQUs7UUFDbkI7UUFFQSxNQUFNQyxVQUFVLE1BQU1DLElBQUFBLGFBQUksRUFBQ1A7UUFDM0IsT0FBT007SUFDVDtBQUNGIn0=