"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
const _validations = require("../../../../../fields/validations");
const _getTranslation = require("../../../../../utilities/getTranslation");
const _scrollToID = require("../../../../utilities/scrollToID");
const _Banner = /*#__PURE__*/ _interop_require_default(require("../../../elements/Banner"));
const _Button = /*#__PURE__*/ _interop_require_default(require("../../../elements/Button"));
const _DraggableSortable = /*#__PURE__*/ _interop_require_default(require("../../../elements/DraggableSortable"));
const _DraggableSortableItem = /*#__PURE__*/ _interop_require_default(require("../../../elements/DraggableSortable/DraggableSortableItem"));
const _ErrorPill = require("../../../elements/ErrorPill");
const _Config = require("../../../utilities/Config");
const _DocumentInfo = require("../../../utilities/DocumentInfo");
const _Locale = require("../../../utilities/Locale");
const _Error = /*#__PURE__*/ _interop_require_default(require("../../Error"));
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _NullifyField = require("../../NullifyField");
const _useField = /*#__PURE__*/ _interop_require_default(require("../../useField"));
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _shared = require("../shared");
const _ArrayRow = require("./ArrayRow");
require("./index.scss");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const baseClass = 'array-field';
const ArrayFieldType = (props)=>{
    const { name, admin: { className, components, condition, description, isSortable = true, readOnly }, fieldTypes, fields, forceRender = false, indexPath, localized, maxRows, minRows, path: pathFromProps, permissions, required, validate = _validations.array } = props;
    const path = pathFromProps || name;
    // eslint-disable-next-line react/destructuring-assignment
    const label = props?.label ?? props?.labels?.singular;
    const CustomRowLabel = components?.RowLabel || undefined;
    const { setDocFieldPreferences } = (0, _DocumentInfo.useDocumentInfo)();
    const { addFieldRow, dispatchFields, removeFieldRow, setModified } = (0, _context.useForm)();
    const submitted = (0, _context.useFormSubmitted)();
    const { code: locale } = (0, _Locale.useLocale)();
    const { i18n, t } = (0, _reacti18next.useTranslation)('fields');
    const { localization } = (0, _Config.useConfig)();
    const editingDefaultLocale = (()=>{
        if (localization && localization.fallback) {
            const defaultLocale = localization.defaultLocale || 'en';
            return locale === defaultLocale;
        }
        return true;
    })();
    // Handle labeling for Arrays, Global Arrays, and Blocks
    const getLabels = (p)=>{
        if (p?.labels) return p.labels;
        if (p?.label) return {
            plural: undefined,
            singular: p.label
        };
        return {
            plural: t('rows'),
            singular: t('row')
        };
    };
    const labels = getLabels(props);
    const memoizedValidate = (0, _react.useCallback)((value, options)=>{
        // alternative locales can be null
        if (!editingDefaultLocale && value === null) {
            return true;
        }
        return validate(value, {
            ...options,
            maxRows,
            minRows,
            required
        });
    }, [
        maxRows,
        minRows,
        required,
        validate,
        editingDefaultLocale
    ]);
    const { errorMessage, rows = [], showError, valid, value } = (0, _useField.default)({
        condition,
        hasRows: true,
        path,
        validate: memoizedValidate
    });
    const addRow = (0, _react.useCallback)(async (rowIndex)=>{
        await addFieldRow({
            path,
            rowIndex
        });
        setModified(true);
        setTimeout(()=>{
            (0, _scrollToID.scrollToID)(`${path}-row-${rowIndex + 1}`);
        }, 0);
    }, [
        addFieldRow,
        path,
        setModified
    ]);
    const duplicateRow = (0, _react.useCallback)((rowIndex)=>{
        dispatchFields({
            type: 'DUPLICATE_ROW',
            path,
            rowIndex
        });
        setModified(true);
        setTimeout(()=>{
            (0, _scrollToID.scrollToID)(`${path}-row-${rowIndex}`);
        }, 0);
    }, [
        dispatchFields,
        path,
        setModified
    ]);
    const removeRow = (0, _react.useCallback)((rowIndex)=>{
        removeFieldRow({
            path,
            rowIndex
        });
        setModified(true);
    }, [
        removeFieldRow,
        path,
        setModified
    ]);
    const moveRow = (0, _react.useCallback)((moveFromIndex, moveToIndex)=>{
        dispatchFields({
            type: 'MOVE_ROW',
            moveFromIndex,
            moveToIndex,
            path
        });
        setModified(true);
    }, [
        dispatchFields,
        path,
        setModified
    ]);
    const toggleCollapseAll = (0, _react.useCallback)((collapsed)=>{
        dispatchFields({
            type: 'SET_ALL_ROWS_COLLAPSED',
            collapsed,
            path,
            setDocFieldPreferences
        });
    }, [
        dispatchFields,
        path,
        setDocFieldPreferences
    ]);
    const setCollapse = (0, _react.useCallback)((rowID, collapsed)=>{
        dispatchFields({
            type: 'SET_ROW_COLLAPSED',
            collapsed,
            path,
            rowID,
            setDocFieldPreferences
        });
    }, [
        dispatchFields,
        path,
        setDocFieldPreferences
    ]);
    const hasMaxRows = maxRows && rows.length >= maxRows;
    const fieldErrorCount = rows.reduce((total, row)=>total + (row?.childErrorPaths?.size || 0), 0) + (valid ? 0 : 1);
    const fieldHasErrors = submitted && fieldErrorCount > 0;
    const showRequired = readOnly && rows.length === 0;
    const showMinRows = rows.length < minRows || required && rows.length === 0;
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            className,
            fieldHasErrors ? `${baseClass}--has-error` : `${baseClass}--has-no-error`
        ].filter(Boolean).join(' '),
        id: `field-${path.replace(/\./g, '__')}`
    }, showError && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__error-wrap`
    }, /*#__PURE__*/ _react.default.createElement(_Error.default, {
        message: errorMessage,
        showError: showError
    })), /*#__PURE__*/ _react.default.createElement("header", {
        className: `${baseClass}__header`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__header-wrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__header-content`
    }, /*#__PURE__*/ _react.default.createElement("h3", {
        className: `${baseClass}__title`
    }, (0, _getTranslation.getTranslation)(label || name, i18n)), fieldHasErrors && fieldErrorCount > 0 && /*#__PURE__*/ _react.default.createElement(_ErrorPill.ErrorPill, {
        count: fieldErrorCount,
        withMessage: true
    })), rows.length > 0 && /*#__PURE__*/ _react.default.createElement("ul", {
        className: `${baseClass}__header-actions`
    }, /*#__PURE__*/ _react.default.createElement("li", null, /*#__PURE__*/ _react.default.createElement("button", {
        className: `${baseClass}__header-action`,
        onClick: ()=>toggleCollapseAll(true),
        type: "button"
    }, t('collapseAll'))), /*#__PURE__*/ _react.default.createElement("li", null, /*#__PURE__*/ _react.default.createElement("button", {
        className: `${baseClass}__header-action`,
        onClick: ()=>toggleCollapseAll(false),
        type: "button"
    }, t('showAll'))))), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        className: `field-description-${path.replace(/\./g, '__')}`,
        description: description,
        path: path,
        value: value
    })), /*#__PURE__*/ _react.default.createElement(_NullifyField.NullifyLocaleField, {
        fieldValue: value,
        localized: localized,
        path: path
    }), (rows.length > 0 || !valid && (showRequired || showMinRows)) && /*#__PURE__*/ _react.default.createElement(_DraggableSortable.default, {
        className: `${baseClass}__draggable-rows`,
        ids: rows.map((row)=>row.id),
        onDragEnd: ({ moveFromIndex, moveToIndex })=>moveRow(moveFromIndex, moveToIndex)
    }, rows.map((row, i)=>/*#__PURE__*/ _react.default.createElement(_DraggableSortableItem.default, {
            disabled: readOnly || !isSortable,
            id: row.id,
            key: row.id
        }, (draggableSortableItemProps)=>/*#__PURE__*/ _react.default.createElement(_ArrayRow.ArrayRow, {
                ...draggableSortableItemProps,
                CustomRowLabel: CustomRowLabel,
                addRow: addRow,
                duplicateRow: duplicateRow,
                fieldTypes: fieldTypes,
                fields: fields,
                forceRender: forceRender,
                hasMaxRows: hasMaxRows,
                indexPath: indexPath,
                isSortable: isSortable,
                labels: labels,
                moveRow: moveRow,
                path: path,
                permissions: permissions,
                readOnly: readOnly,
                removeRow: removeRow,
                row: row,
                rowCount: rows.length,
                rowIndex: i,
                setCollapse: setCollapse
            }))), !valid && /*#__PURE__*/ _react.default.createElement(_react.default.Fragment, null, showRequired && /*#__PURE__*/ _react.default.createElement(_Banner.default, null, t('validation:fieldHasNo', {
        label: (0, _getTranslation.getTranslation)(labels.plural, i18n)
    })), showMinRows && /*#__PURE__*/ _react.default.createElement(_Banner.default, {
        type: "error"
    }, t('validation:requiresAtLeast', {
        count: minRows,
        label: (0, _getTranslation.getTranslation)(minRows ? labels.plural : labels.singular, i18n) || t(minRows > 1 ? 'general:row' : 'general:rows')
    })))), !readOnly && !hasMaxRows && /*#__PURE__*/ _react.default.createElement(_Button.default, {
        buttonStyle: "icon-label",
        className: `${baseClass}__add-row`,
        icon: "plus",
        iconPosition: "left",
        iconStyle: "with-border",
        onClick: ()=>addRow(value || 0)
    }, t('addLabel', {
        label: (0, _getTranslation.getTranslation)(labels.singular, i18n)
    })));
};
const _default = (0, _withCondition.default)(ArrayFieldType);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL0FycmF5L2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHVzZVRyYW5zbGF0aW9uIH0gZnJvbSAncmVhY3QtaTE4bmV4dCdcblxuaW1wb3J0IHR5cGUgeyBQcm9wcyB9IGZyb20gJy4vdHlwZXMnXG5cbmltcG9ydCB7IGFycmF5IH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZmllbGRzL3ZhbGlkYXRpb25zJ1xuaW1wb3J0IHsgZ2V0VHJhbnNsYXRpb24gfSBmcm9tICcuLi8uLi8uLi8uLi8uLi91dGlsaXRpZXMvZ2V0VHJhbnNsYXRpb24nXG5pbXBvcnQgeyBzY3JvbGxUb0lEIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbGl0aWVzL3Njcm9sbFRvSUQnXG5pbXBvcnQgQmFubmVyIGZyb20gJy4uLy4uLy4uL2VsZW1lbnRzL0Jhbm5lcidcbmltcG9ydCBCdXR0b24gZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvQnV0dG9uJ1xuaW1wb3J0IERyYWdnYWJsZVNvcnRhYmxlIGZyb20gJy4uLy4uLy4uL2VsZW1lbnRzL0RyYWdnYWJsZVNvcnRhYmxlJ1xuaW1wb3J0IERyYWdnYWJsZVNvcnRhYmxlSXRlbSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9EcmFnZ2FibGVTb3J0YWJsZS9EcmFnZ2FibGVTb3J0YWJsZUl0ZW0nXG5pbXBvcnQgeyBFcnJvclBpbGwgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9FcnJvclBpbGwnXG5pbXBvcnQgeyB1c2VDb25maWcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXRpZXMvQ29uZmlnJ1xuaW1wb3J0IHsgdXNlRG9jdW1lbnRJbmZvIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0RvY3VtZW50SW5mbydcbmltcG9ydCB7IHVzZUxvY2FsZSB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9Mb2NhbGUnXG5pbXBvcnQgRXJyb3IgZnJvbSAnLi4vLi4vRXJyb3InXG5pbXBvcnQgRmllbGREZXNjcmlwdGlvbiBmcm9tICcuLi8uLi9GaWVsZERlc2NyaXB0aW9uJ1xuaW1wb3J0IHsgdXNlRm9ybSwgdXNlRm9ybVN1Ym1pdHRlZCB9IGZyb20gJy4uLy4uL0Zvcm0vY29udGV4dCdcbmltcG9ydCB7IE51bGxpZnlMb2NhbGVGaWVsZCB9IGZyb20gJy4uLy4uL051bGxpZnlGaWVsZCdcbmltcG9ydCB1c2VGaWVsZCBmcm9tICcuLi8uLi91c2VGaWVsZCdcbmltcG9ydCB3aXRoQ29uZGl0aW9uIGZyb20gJy4uLy4uL3dpdGhDb25kaXRpb24nXG5pbXBvcnQgeyBmaWVsZEJhc2VDbGFzcyB9IGZyb20gJy4uL3NoYXJlZCdcbmltcG9ydCB7IEFycmF5Um93IH0gZnJvbSAnLi9BcnJheVJvdydcbmltcG9ydCAnLi9pbmRleC5zY3NzJ1xuXG5jb25zdCBiYXNlQ2xhc3MgPSAnYXJyYXktZmllbGQnXG5cbmNvbnN0IEFycmF5RmllbGRUeXBlOiBSZWFjdC5GQzxQcm9wcz4gPSAocHJvcHMpID0+IHtcbiAgY29uc3Qge1xuICAgIG5hbWUsXG4gICAgYWRtaW46IHsgY2xhc3NOYW1lLCBjb21wb25lbnRzLCBjb25kaXRpb24sIGRlc2NyaXB0aW9uLCBpc1NvcnRhYmxlID0gdHJ1ZSwgcmVhZE9ubHkgfSxcbiAgICBmaWVsZFR5cGVzLFxuICAgIGZpZWxkcyxcbiAgICBmb3JjZVJlbmRlciA9IGZhbHNlLFxuICAgIGluZGV4UGF0aCxcbiAgICBsb2NhbGl6ZWQsXG4gICAgbWF4Um93cyxcbiAgICBtaW5Sb3dzLFxuICAgIHBhdGg6IHBhdGhGcm9tUHJvcHMsXG4gICAgcGVybWlzc2lvbnMsXG4gICAgcmVxdWlyZWQsXG4gICAgdmFsaWRhdGUgPSBhcnJheSxcbiAgfSA9IHByb3BzXG5cbiAgY29uc3QgcGF0aCA9IHBhdGhGcm9tUHJvcHMgfHwgbmFtZVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9kZXN0cnVjdHVyaW5nLWFzc2lnbm1lbnRcbiAgY29uc3QgbGFiZWwgPSBwcm9wcz8ubGFiZWwgPz8gcHJvcHM/LmxhYmVscz8uc2luZ3VsYXJcblxuICBjb25zdCBDdXN0b21Sb3dMYWJlbCA9IGNvbXBvbmVudHM/LlJvd0xhYmVsIHx8IHVuZGVmaW5lZFxuXG4gIGNvbnN0IHsgc2V0RG9jRmllbGRQcmVmZXJlbmNlcyB9ID0gdXNlRG9jdW1lbnRJbmZvKClcbiAgY29uc3QgeyBhZGRGaWVsZFJvdywgZGlzcGF0Y2hGaWVsZHMsIHJlbW92ZUZpZWxkUm93LCBzZXRNb2RpZmllZCB9ID0gdXNlRm9ybSgpXG4gIGNvbnN0IHN1Ym1pdHRlZCA9IHVzZUZvcm1TdWJtaXR0ZWQoKVxuICBjb25zdCB7IGNvZGU6IGxvY2FsZSB9ID0gdXNlTG9jYWxlKClcbiAgY29uc3QgeyBpMThuLCB0IH0gPSB1c2VUcmFuc2xhdGlvbignZmllbGRzJylcbiAgY29uc3QgeyBsb2NhbGl6YXRpb24gfSA9IHVzZUNvbmZpZygpXG5cbiAgY29uc3QgZWRpdGluZ0RlZmF1bHRMb2NhbGUgPSAoKCkgPT4ge1xuICAgIGlmIChsb2NhbGl6YXRpb24gJiYgbG9jYWxpemF0aW9uLmZhbGxiYWNrKSB7XG4gICAgICBjb25zdCBkZWZhdWx0TG9jYWxlID0gbG9jYWxpemF0aW9uLmRlZmF1bHRMb2NhbGUgfHwgJ2VuJ1xuICAgICAgcmV0dXJuIGxvY2FsZSA9PT0gZGVmYXVsdExvY2FsZVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlXG4gIH0pKClcblxuICAvLyBIYW5kbGUgbGFiZWxpbmcgZm9yIEFycmF5cywgR2xvYmFsIEFycmF5cywgYW5kIEJsb2Nrc1xuICBjb25zdCBnZXRMYWJlbHMgPSAocDogUHJvcHMpID0+IHtcbiAgICBpZiAocD8ubGFiZWxzKSByZXR1cm4gcC5sYWJlbHNcbiAgICBpZiAocD8ubGFiZWwpIHJldHVybiB7IHBsdXJhbDogdW5kZWZpbmVkLCBzaW5ndWxhcjogcC5sYWJlbCB9XG4gICAgcmV0dXJuIHsgcGx1cmFsOiB0KCdyb3dzJyksIHNpbmd1bGFyOiB0KCdyb3cnKSB9XG4gIH1cblxuICBjb25zdCBsYWJlbHMgPSBnZXRMYWJlbHMocHJvcHMpXG5cbiAgY29uc3QgbWVtb2l6ZWRWYWxpZGF0ZSA9IHVzZUNhbGxiYWNrKFxuICAgICh2YWx1ZSwgb3B0aW9ucykgPT4ge1xuICAgICAgLy8gYWx0ZXJuYXRpdmUgbG9jYWxlcyBjYW4gYmUgbnVsbFxuICAgICAgaWYgKCFlZGl0aW5nRGVmYXVsdExvY2FsZSAmJiB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbGlkYXRlKHZhbHVlLCB7IC4uLm9wdGlvbnMsIG1heFJvd3MsIG1pblJvd3MsIHJlcXVpcmVkIH0pXG4gICAgfSxcbiAgICBbbWF4Um93cywgbWluUm93cywgcmVxdWlyZWQsIHZhbGlkYXRlLCBlZGl0aW5nRGVmYXVsdExvY2FsZV0sXG4gIClcblxuICBjb25zdCB7XG4gICAgZXJyb3JNZXNzYWdlLFxuICAgIHJvd3MgPSBbXSxcbiAgICBzaG93RXJyb3IsXG4gICAgdmFsaWQsXG4gICAgdmFsdWUsXG4gIH0gPSB1c2VGaWVsZDxudW1iZXI+KHtcbiAgICBjb25kaXRpb24sXG4gICAgaGFzUm93czogdHJ1ZSxcbiAgICBwYXRoLFxuICAgIHZhbGlkYXRlOiBtZW1vaXplZFZhbGlkYXRlLFxuICB9KVxuXG4gIGNvbnN0IGFkZFJvdyA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jIChyb3dJbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICBhd2FpdCBhZGRGaWVsZFJvdyh7IHBhdGgsIHJvd0luZGV4IH0pXG4gICAgICBzZXRNb2RpZmllZCh0cnVlKVxuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc2Nyb2xsVG9JRChgJHtwYXRofS1yb3ctJHtyb3dJbmRleCArIDF9YClcbiAgICAgIH0sIDApXG4gICAgfSxcbiAgICBbYWRkRmllbGRSb3csIHBhdGgsIHNldE1vZGlmaWVkXSxcbiAgKVxuXG4gIGNvbnN0IGR1cGxpY2F0ZVJvdyA9IHVzZUNhbGxiYWNrKFxuICAgIChyb3dJbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICBkaXNwYXRjaEZpZWxkcyh7IHR5cGU6ICdEVVBMSUNBVEVfUk9XJywgcGF0aCwgcm93SW5kZXggfSlcbiAgICAgIHNldE1vZGlmaWVkKHRydWUpXG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzY3JvbGxUb0lEKGAke3BhdGh9LXJvdy0ke3Jvd0luZGV4fWApXG4gICAgICB9LCAwKVxuICAgIH0sXG4gICAgW2Rpc3BhdGNoRmllbGRzLCBwYXRoLCBzZXRNb2RpZmllZF0sXG4gIClcblxuICBjb25zdCByZW1vdmVSb3cgPSB1c2VDYWxsYmFjayhcbiAgICAocm93SW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgcmVtb3ZlRmllbGRSb3coeyBwYXRoLCByb3dJbmRleCB9KVxuICAgICAgc2V0TW9kaWZpZWQodHJ1ZSlcbiAgICB9LFxuICAgIFtyZW1vdmVGaWVsZFJvdywgcGF0aCwgc2V0TW9kaWZpZWRdLFxuICApXG5cbiAgY29uc3QgbW92ZVJvdyA9IHVzZUNhbGxiYWNrKFxuICAgIChtb3ZlRnJvbUluZGV4OiBudW1iZXIsIG1vdmVUb0luZGV4OiBudW1iZXIpID0+IHtcbiAgICAgIGRpc3BhdGNoRmllbGRzKHsgdHlwZTogJ01PVkVfUk9XJywgbW92ZUZyb21JbmRleCwgbW92ZVRvSW5kZXgsIHBhdGggfSlcbiAgICAgIHNldE1vZGlmaWVkKHRydWUpXG4gICAgfSxcbiAgICBbZGlzcGF0Y2hGaWVsZHMsIHBhdGgsIHNldE1vZGlmaWVkXSxcbiAgKVxuXG4gIGNvbnN0IHRvZ2dsZUNvbGxhcHNlQWxsID0gdXNlQ2FsbGJhY2soXG4gICAgKGNvbGxhcHNlZDogYm9vbGVhbikgPT4ge1xuICAgICAgZGlzcGF0Y2hGaWVsZHMoeyB0eXBlOiAnU0VUX0FMTF9ST1dTX0NPTExBUFNFRCcsIGNvbGxhcHNlZCwgcGF0aCwgc2V0RG9jRmllbGRQcmVmZXJlbmNlcyB9KVxuICAgIH0sXG4gICAgW2Rpc3BhdGNoRmllbGRzLCBwYXRoLCBzZXREb2NGaWVsZFByZWZlcmVuY2VzXSxcbiAgKVxuXG4gIGNvbnN0IHNldENvbGxhcHNlID0gdXNlQ2FsbGJhY2soXG4gICAgKHJvd0lEOiBzdHJpbmcsIGNvbGxhcHNlZDogYm9vbGVhbikgPT4ge1xuICAgICAgZGlzcGF0Y2hGaWVsZHMoeyB0eXBlOiAnU0VUX1JPV19DT0xMQVBTRUQnLCBjb2xsYXBzZWQsIHBhdGgsIHJvd0lELCBzZXREb2NGaWVsZFByZWZlcmVuY2VzIH0pXG4gICAgfSxcbiAgICBbZGlzcGF0Y2hGaWVsZHMsIHBhdGgsIHNldERvY0ZpZWxkUHJlZmVyZW5jZXNdLFxuICApXG5cbiAgY29uc3QgaGFzTWF4Um93cyA9IG1heFJvd3MgJiYgcm93cy5sZW5ndGggPj0gbWF4Um93c1xuXG4gIGNvbnN0IGZpZWxkRXJyb3JDb3VudCA9XG4gICAgcm93cy5yZWR1Y2UoKHRvdGFsLCByb3cpID0+IHRvdGFsICsgKHJvdz8uY2hpbGRFcnJvclBhdGhzPy5zaXplIHx8IDApLCAwKSArICh2YWxpZCA/IDAgOiAxKVxuXG4gIGNvbnN0IGZpZWxkSGFzRXJyb3JzID0gc3VibWl0dGVkICYmIGZpZWxkRXJyb3JDb3VudCA+IDBcblxuICBjb25zdCBzaG93UmVxdWlyZWQgPSByZWFkT25seSAmJiByb3dzLmxlbmd0aCA9PT0gMFxuICBjb25zdCBzaG93TWluUm93cyA9IHJvd3MubGVuZ3RoIDwgbWluUm93cyB8fCAocmVxdWlyZWQgJiYgcm93cy5sZW5ndGggPT09IDApXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjbGFzc05hbWU9e1tcbiAgICAgICAgZmllbGRCYXNlQ2xhc3MsXG4gICAgICAgIGJhc2VDbGFzcyxcbiAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICBmaWVsZEhhc0Vycm9ycyA/IGAke2Jhc2VDbGFzc30tLWhhcy1lcnJvcmAgOiBgJHtiYXNlQ2xhc3N9LS1oYXMtbm8tZXJyb3JgLFxuICAgICAgXVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgIC5qb2luKCcgJyl9XG4gICAgICBpZD17YGZpZWxkLSR7cGF0aC5yZXBsYWNlKC9cXC4vZywgJ19fJyl9YH1cbiAgICA+XG4gICAgICB7c2hvd0Vycm9yICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2Vycm9yLXdyYXBgfT5cbiAgICAgICAgICA8RXJyb3IgbWVzc2FnZT17ZXJyb3JNZXNzYWdlfSBzaG93RXJyb3I9e3Nob3dFcnJvcn0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgICAgPGhlYWRlciBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2hlYWRlcmB9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9faGVhZGVyLXdyYXBgfT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9faGVhZGVyLWNvbnRlbnRgfT5cbiAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX3RpdGxlYH0+e2dldFRyYW5zbGF0aW9uKGxhYmVsIHx8IG5hbWUsIGkxOG4pfTwvaDM+XG4gICAgICAgICAgICB7ZmllbGRIYXNFcnJvcnMgJiYgZmllbGRFcnJvckNvdW50ID4gMCAmJiAoXG4gICAgICAgICAgICAgIDxFcnJvclBpbGwgY291bnQ9e2ZpZWxkRXJyb3JDb3VudH0gd2l0aE1lc3NhZ2UgLz5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAge3Jvd3MubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgICA8dWwgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19oZWFkZXItYWN0aW9uc2B9PlxuICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19oZWFkZXItYWN0aW9uYH1cbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRvZ2dsZUNvbGxhcHNlQWxsKHRydWUpfVxuICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge3QoJ2NvbGxhcHNlQWxsJyl9XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2hlYWRlci1hY3Rpb25gfVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gdG9nZ2xlQ29sbGFwc2VBbGwoZmFsc2UpfVxuICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAge3QoJ3Nob3dBbGwnKX1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxGaWVsZERlc2NyaXB0aW9uXG4gICAgICAgICAgY2xhc3NOYW1lPXtgZmllbGQtZGVzY3JpcHRpb24tJHtwYXRoLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1gfVxuICAgICAgICAgIGRlc2NyaXB0aW9uPXtkZXNjcmlwdGlvbn1cbiAgICAgICAgICBwYXRoPXtwYXRofVxuICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgLz5cbiAgICAgIDwvaGVhZGVyPlxuXG4gICAgICA8TnVsbGlmeUxvY2FsZUZpZWxkIGZpZWxkVmFsdWU9e3ZhbHVlfSBsb2NhbGl6ZWQ9e2xvY2FsaXplZH0gcGF0aD17cGF0aH0gLz5cbiAgICAgIHsocm93cy5sZW5ndGggPiAwIHx8ICghdmFsaWQgJiYgKHNob3dSZXF1aXJlZCB8fCBzaG93TWluUm93cykpKSAmJiAoXG4gICAgICAgIDxEcmFnZ2FibGVTb3J0YWJsZVxuICAgICAgICAgIGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fZHJhZ2dhYmxlLXJvd3NgfVxuICAgICAgICAgIGlkcz17cm93cy5tYXAoKHJvdykgPT4gcm93LmlkKX1cbiAgICAgICAgICBvbkRyYWdFbmQ9eyh7IG1vdmVGcm9tSW5kZXgsIG1vdmVUb0luZGV4IH0pID0+IG1vdmVSb3cobW92ZUZyb21JbmRleCwgbW92ZVRvSW5kZXgpfVxuICAgICAgICA+XG4gICAgICAgICAge3Jvd3MubWFwKChyb3csIGkpID0+IChcbiAgICAgICAgICAgIDxEcmFnZ2FibGVTb3J0YWJsZUl0ZW0gZGlzYWJsZWQ9e3JlYWRPbmx5IHx8ICFpc1NvcnRhYmxlfSBpZD17cm93LmlkfSBrZXk9e3Jvdy5pZH0+XG4gICAgICAgICAgICAgIHsoZHJhZ2dhYmxlU29ydGFibGVJdGVtUHJvcHMpID0+IChcbiAgICAgICAgICAgICAgICA8QXJyYXlSb3dcbiAgICAgICAgICAgICAgICAgIHsuLi5kcmFnZ2FibGVTb3J0YWJsZUl0ZW1Qcm9wc31cbiAgICAgICAgICAgICAgICAgIEN1c3RvbVJvd0xhYmVsPXtDdXN0b21Sb3dMYWJlbH1cbiAgICAgICAgICAgICAgICAgIGFkZFJvdz17YWRkUm93fVxuICAgICAgICAgICAgICAgICAgZHVwbGljYXRlUm93PXtkdXBsaWNhdGVSb3d9XG4gICAgICAgICAgICAgICAgICBmaWVsZFR5cGVzPXtmaWVsZFR5cGVzfVxuICAgICAgICAgICAgICAgICAgZmllbGRzPXtmaWVsZHN9XG4gICAgICAgICAgICAgICAgICBmb3JjZVJlbmRlcj17Zm9yY2VSZW5kZXJ9XG4gICAgICAgICAgICAgICAgICBoYXNNYXhSb3dzPXtoYXNNYXhSb3dzfVxuICAgICAgICAgICAgICAgICAgaW5kZXhQYXRoPXtpbmRleFBhdGh9XG4gICAgICAgICAgICAgICAgICBpc1NvcnRhYmxlPXtpc1NvcnRhYmxlfVxuICAgICAgICAgICAgICAgICAgbGFiZWxzPXtsYWJlbHN9XG4gICAgICAgICAgICAgICAgICBtb3ZlUm93PXttb3ZlUm93fVxuICAgICAgICAgICAgICAgICAgcGF0aD17cGF0aH1cbiAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zPXtwZXJtaXNzaW9uc31cbiAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXtyZWFkT25seX1cbiAgICAgICAgICAgICAgICAgIHJlbW92ZVJvdz17cmVtb3ZlUm93fVxuICAgICAgICAgICAgICAgICAgcm93PXtyb3d9XG4gICAgICAgICAgICAgICAgICByb3dDb3VudD17cm93cy5sZW5ndGh9XG4gICAgICAgICAgICAgICAgICByb3dJbmRleD17aX1cbiAgICAgICAgICAgICAgICAgIHNldENvbGxhcHNlPXtzZXRDb2xsYXBzZX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9EcmFnZ2FibGVTb3J0YWJsZUl0ZW0+XG4gICAgICAgICAgKSl9XG4gICAgICAgICAgeyF2YWxpZCAmJiAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgIHtzaG93UmVxdWlyZWQgJiYgKFxuICAgICAgICAgICAgICAgIDxCYW5uZXI+XG4gICAgICAgICAgICAgICAgICB7dCgndmFsaWRhdGlvbjpmaWVsZEhhc05vJywgeyBsYWJlbDogZ2V0VHJhbnNsYXRpb24obGFiZWxzLnBsdXJhbCwgaTE4bikgfSl9XG4gICAgICAgICAgICAgICAgPC9CYW5uZXI+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtzaG93TWluUm93cyAmJiAoXG4gICAgICAgICAgICAgICAgPEJhbm5lciB0eXBlPVwiZXJyb3JcIj5cbiAgICAgICAgICAgICAgICAgIHt0KCd2YWxpZGF0aW9uOnJlcXVpcmVzQXRMZWFzdCcsIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IG1pblJvd3MsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOlxuICAgICAgICAgICAgICAgICAgICAgIGdldFRyYW5zbGF0aW9uKG1pblJvd3MgPyBsYWJlbHMucGx1cmFsIDogbGFiZWxzLnNpbmd1bGFyLCBpMThuKSB8fFxuICAgICAgICAgICAgICAgICAgICAgIHQobWluUm93cyA+IDEgPyAnZ2VuZXJhbDpyb3cnIDogJ2dlbmVyYWw6cm93cycpLFxuICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPC9CYW5uZXI+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRHJhZ2dhYmxlU29ydGFibGU+XG4gICAgICApfVxuICAgICAgeyFyZWFkT25seSAmJiAhaGFzTWF4Um93cyAmJiAoXG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBidXR0b25TdHlsZT1cImljb24tbGFiZWxcIlxuICAgICAgICAgIGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fYWRkLXJvd2B9XG4gICAgICAgICAgaWNvbj1cInBsdXNcIlxuICAgICAgICAgIGljb25Qb3NpdGlvbj1cImxlZnRcIlxuICAgICAgICAgIGljb25TdHlsZT1cIndpdGgtYm9yZGVyXCJcbiAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBhZGRSb3codmFsdWUgfHwgMCl9XG4gICAgICAgID5cbiAgICAgICAgICB7dCgnYWRkTGFiZWwnLCB7IGxhYmVsOiBnZXRUcmFuc2xhdGlvbihsYWJlbHMuc2luZ3VsYXIsIGkxOG4pIH0pfVxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aENvbmRpdGlvbihBcnJheUZpZWxkVHlwZSlcbiJdLCJuYW1lcyI6WyJiYXNlQ2xhc3MiLCJBcnJheUZpZWxkVHlwZSIsInByb3BzIiwibmFtZSIsImFkbWluIiwiY2xhc3NOYW1lIiwiY29tcG9uZW50cyIsImNvbmRpdGlvbiIsImRlc2NyaXB0aW9uIiwiaXNTb3J0YWJsZSIsInJlYWRPbmx5IiwiZmllbGRUeXBlcyIsImZpZWxkcyIsImZvcmNlUmVuZGVyIiwiaW5kZXhQYXRoIiwibG9jYWxpemVkIiwibWF4Um93cyIsIm1pblJvd3MiLCJwYXRoIiwicGF0aEZyb21Qcm9wcyIsInBlcm1pc3Npb25zIiwicmVxdWlyZWQiLCJ2YWxpZGF0ZSIsImFycmF5IiwibGFiZWwiLCJsYWJlbHMiLCJzaW5ndWxhciIsIkN1c3RvbVJvd0xhYmVsIiwiUm93TGFiZWwiLCJ1bmRlZmluZWQiLCJzZXREb2NGaWVsZFByZWZlcmVuY2VzIiwidXNlRG9jdW1lbnRJbmZvIiwiYWRkRmllbGRSb3ciLCJkaXNwYXRjaEZpZWxkcyIsInJlbW92ZUZpZWxkUm93Iiwic2V0TW9kaWZpZWQiLCJ1c2VGb3JtIiwic3VibWl0dGVkIiwidXNlRm9ybVN1Ym1pdHRlZCIsImNvZGUiLCJsb2NhbGUiLCJ1c2VMb2NhbGUiLCJpMThuIiwidCIsInVzZVRyYW5zbGF0aW9uIiwibG9jYWxpemF0aW9uIiwidXNlQ29uZmlnIiwiZWRpdGluZ0RlZmF1bHRMb2NhbGUiLCJmYWxsYmFjayIsImRlZmF1bHRMb2NhbGUiLCJnZXRMYWJlbHMiLCJwIiwicGx1cmFsIiwibWVtb2l6ZWRWYWxpZGF0ZSIsInVzZUNhbGxiYWNrIiwidmFsdWUiLCJvcHRpb25zIiwiZXJyb3JNZXNzYWdlIiwicm93cyIsInNob3dFcnJvciIsInZhbGlkIiwidXNlRmllbGQiLCJoYXNSb3dzIiwiYWRkUm93Iiwicm93SW5kZXgiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsVG9JRCIsImR1cGxpY2F0ZVJvdyIsInR5cGUiLCJyZW1vdmVSb3ciLCJtb3ZlUm93IiwibW92ZUZyb21JbmRleCIsIm1vdmVUb0luZGV4IiwidG9nZ2xlQ29sbGFwc2VBbGwiLCJjb2xsYXBzZWQiLCJzZXRDb2xsYXBzZSIsInJvd0lEIiwiaGFzTWF4Um93cyIsImxlbmd0aCIsImZpZWxkRXJyb3JDb3VudCIsInJlZHVjZSIsInRvdGFsIiwicm93IiwiY2hpbGRFcnJvclBhdGhzIiwic2l6ZSIsImZpZWxkSGFzRXJyb3JzIiwic2hvd1JlcXVpcmVkIiwic2hvd01pblJvd3MiLCJkaXYiLCJmaWVsZEJhc2VDbGFzcyIsImZpbHRlciIsIkJvb2xlYW4iLCJqb2luIiwiaWQiLCJyZXBsYWNlIiwiRXJyb3IiLCJtZXNzYWdlIiwiaGVhZGVyIiwiaDMiLCJnZXRUcmFuc2xhdGlvbiIsIkVycm9yUGlsbCIsImNvdW50Iiwid2l0aE1lc3NhZ2UiLCJ1bCIsImxpIiwiYnV0dG9uIiwib25DbGljayIsIkZpZWxkRGVzY3JpcHRpb24iLCJOdWxsaWZ5TG9jYWxlRmllbGQiLCJmaWVsZFZhbHVlIiwiRHJhZ2dhYmxlU29ydGFibGUiLCJpZHMiLCJtYXAiLCJvbkRyYWdFbmQiLCJpIiwiRHJhZ2dhYmxlU29ydGFibGVJdGVtIiwiZGlzYWJsZWQiLCJrZXkiLCJkcmFnZ2FibGVTb3J0YWJsZUl0ZW1Qcm9wcyIsIkFycmF5Um93Iiwicm93Q291bnQiLCJSZWFjdCIsIkZyYWdtZW50IiwiQmFubmVyIiwiQnV0dG9uIiwiYnV0dG9uU3R5bGUiLCJpY29uIiwiaWNvblBvc2l0aW9uIiwiaWNvblN0eWxlIiwid2l0aENvbmRpdGlvbiJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFxU0E7OztlQUFBOzs7K0RBclNtQzs4QkFDSjs2QkFJVDtnQ0FDUzs0QkFDSjsrREFDUjsrREFDQTswRUFDVzs4RUFDSTsyQkFDUjt3QkFDQTs4QkFDTTt3QkFDTjs4REFDUjt5RUFDVzt5QkFDYTs4QkFDUDtpRUFDZDtzRUFDSzt3QkFDSzswQkFDTjtRQUNsQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFUCxNQUFNQSxZQUFZO0FBRWxCLE1BQU1DLGlCQUFrQyxDQUFDQztJQUN2QyxNQUFNLEVBQ0pDLElBQUksRUFDSkMsT0FBTyxFQUFFQyxTQUFTLEVBQUVDLFVBQVUsRUFBRUMsU0FBUyxFQUFFQyxXQUFXLEVBQUVDLGFBQWEsSUFBSSxFQUFFQyxRQUFRLEVBQUUsRUFDckZDLFVBQVUsRUFDVkMsTUFBTSxFQUNOQyxjQUFjLEtBQUssRUFDbkJDLFNBQVMsRUFDVEMsU0FBUyxFQUNUQyxPQUFPLEVBQ1BDLE9BQU8sRUFDUEMsTUFBTUMsYUFBYSxFQUNuQkMsV0FBVyxFQUNYQyxRQUFRLEVBQ1JDLFdBQVdDLGtCQUFLLEVBQ2pCLEdBQUdyQjtJQUVKLE1BQU1nQixPQUFPQyxpQkFBaUJoQjtJQUU5QiwwREFBMEQ7SUFDMUQsTUFBTXFCLFFBQVF0QixPQUFPc0IsU0FBU3RCLE9BQU91QixRQUFRQztJQUU3QyxNQUFNQyxpQkFBaUJyQixZQUFZc0IsWUFBWUM7SUFFL0MsTUFBTSxFQUFFQyxzQkFBc0IsRUFBRSxHQUFHQyxJQUFBQSw2QkFBZTtJQUNsRCxNQUFNLEVBQUVDLFdBQVcsRUFBRUMsY0FBYyxFQUFFQyxjQUFjLEVBQUVDLFdBQVcsRUFBRSxHQUFHQyxJQUFBQSxnQkFBTztJQUM1RSxNQUFNQyxZQUFZQyxJQUFBQSx5QkFBZ0I7SUFDbEMsTUFBTSxFQUFFQyxNQUFNQyxNQUFNLEVBQUUsR0FBR0MsSUFBQUEsaUJBQVM7SUFDbEMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLENBQUMsRUFBRSxHQUFHQyxJQUFBQSw0QkFBYyxFQUFDO0lBQ25DLE1BQU0sRUFBRUMsWUFBWSxFQUFFLEdBQUdDLElBQUFBLGlCQUFTO0lBRWxDLE1BQU1DLHVCQUF1QixBQUFDLENBQUE7UUFDNUIsSUFBSUYsZ0JBQWdCQSxhQUFhRyxRQUFRLEVBQUU7WUFDekMsTUFBTUMsZ0JBQWdCSixhQUFhSSxhQUFhLElBQUk7WUFDcEQsT0FBT1QsV0FBV1M7UUFDcEI7UUFFQSxPQUFPO0lBQ1QsQ0FBQTtJQUVBLHdEQUF3RDtJQUN4RCxNQUFNQyxZQUFZLENBQUNDO1FBQ2pCLElBQUlBLEdBQUcxQixRQUFRLE9BQU8wQixFQUFFMUIsTUFBTTtRQUM5QixJQUFJMEIsR0FBRzNCLE9BQU8sT0FBTztZQUFFNEIsUUFBUXZCO1lBQVdILFVBQVV5QixFQUFFM0IsS0FBSztRQUFDO1FBQzVELE9BQU87WUFBRTRCLFFBQVFULEVBQUU7WUFBU2pCLFVBQVVpQixFQUFFO1FBQU87SUFDakQ7SUFFQSxNQUFNbEIsU0FBU3lCLFVBQVVoRDtJQUV6QixNQUFNbUQsbUJBQW1CQyxJQUFBQSxrQkFBVyxFQUNsQyxDQUFDQyxPQUFPQztRQUNOLGtDQUFrQztRQUNsQyxJQUFJLENBQUNULHdCQUF3QlEsVUFBVSxNQUFNO1lBQzNDLE9BQU87UUFDVDtRQUNBLE9BQU9qQyxTQUFTaUMsT0FBTztZQUFFLEdBQUdDLE9BQU87WUFBRXhDO1lBQVNDO1lBQVNJO1FBQVM7SUFDbEUsR0FDQTtRQUFDTDtRQUFTQztRQUFTSTtRQUFVQztRQUFVeUI7S0FBcUI7SUFHOUQsTUFBTSxFQUNKVSxZQUFZLEVBQ1pDLE9BQU8sRUFBRSxFQUNUQyxTQUFTLEVBQ1RDLEtBQUssRUFDTEwsS0FBSyxFQUNOLEdBQUdNLElBQUFBLGlCQUFRLEVBQVM7UUFDbkJ0RDtRQUNBdUQsU0FBUztRQUNUNUM7UUFDQUksVUFBVStCO0lBQ1o7SUFFQSxNQUFNVSxTQUFTVCxJQUFBQSxrQkFBVyxFQUN4QixPQUFPVTtRQUNMLE1BQU1oQyxZQUFZO1lBQUVkO1lBQU04QztRQUFTO1FBQ25DN0IsWUFBWTtRQUVaOEIsV0FBVztZQUNUQyxJQUFBQSxzQkFBVSxFQUFDLENBQUMsRUFBRWhELEtBQUssS0FBSyxFQUFFOEMsV0FBVyxFQUFFLENBQUM7UUFDMUMsR0FBRztJQUNMLEdBQ0E7UUFBQ2hDO1FBQWFkO1FBQU1pQjtLQUFZO0lBR2xDLE1BQU1nQyxlQUFlYixJQUFBQSxrQkFBVyxFQUM5QixDQUFDVTtRQUNDL0IsZUFBZTtZQUFFbUMsTUFBTTtZQUFpQmxEO1lBQU04QztRQUFTO1FBQ3ZEN0IsWUFBWTtRQUVaOEIsV0FBVztZQUNUQyxJQUFBQSxzQkFBVSxFQUFDLENBQUMsRUFBRWhELEtBQUssS0FBSyxFQUFFOEMsU0FBUyxDQUFDO1FBQ3RDLEdBQUc7SUFDTCxHQUNBO1FBQUMvQjtRQUFnQmY7UUFBTWlCO0tBQVk7SUFHckMsTUFBTWtDLFlBQVlmLElBQUFBLGtCQUFXLEVBQzNCLENBQUNVO1FBQ0M5QixlQUFlO1lBQUVoQjtZQUFNOEM7UUFBUztRQUNoQzdCLFlBQVk7SUFDZCxHQUNBO1FBQUNEO1FBQWdCaEI7UUFBTWlCO0tBQVk7SUFHckMsTUFBTW1DLFVBQVVoQixJQUFBQSxrQkFBVyxFQUN6QixDQUFDaUIsZUFBdUJDO1FBQ3RCdkMsZUFBZTtZQUFFbUMsTUFBTTtZQUFZRztZQUFlQztZQUFhdEQ7UUFBSztRQUNwRWlCLFlBQVk7SUFDZCxHQUNBO1FBQUNGO1FBQWdCZjtRQUFNaUI7S0FBWTtJQUdyQyxNQUFNc0Msb0JBQW9CbkIsSUFBQUEsa0JBQVcsRUFDbkMsQ0FBQ29CO1FBQ0N6QyxlQUFlO1lBQUVtQyxNQUFNO1lBQTBCTTtZQUFXeEQ7WUFBTVk7UUFBdUI7SUFDM0YsR0FDQTtRQUFDRztRQUFnQmY7UUFBTVk7S0FBdUI7SUFHaEQsTUFBTTZDLGNBQWNyQixJQUFBQSxrQkFBVyxFQUM3QixDQUFDc0IsT0FBZUY7UUFDZHpDLGVBQWU7WUFBRW1DLE1BQU07WUFBcUJNO1lBQVd4RDtZQUFNMEQ7WUFBTzlDO1FBQXVCO0lBQzdGLEdBQ0E7UUFBQ0c7UUFBZ0JmO1FBQU1ZO0tBQXVCO0lBR2hELE1BQU0rQyxhQUFhN0QsV0FBVzBDLEtBQUtvQixNQUFNLElBQUk5RDtJQUU3QyxNQUFNK0Qsa0JBQ0pyQixLQUFLc0IsTUFBTSxDQUFDLENBQUNDLE9BQU9DLE1BQVFELFFBQVNDLENBQUFBLEtBQUtDLGlCQUFpQkMsUUFBUSxDQUFBLEdBQUksS0FBTXhCLENBQUFBLFFBQVEsSUFBSSxDQUFBO0lBRTNGLE1BQU15QixpQkFBaUJoRCxhQUFhMEMsa0JBQWtCO0lBRXRELE1BQU1PLGVBQWU1RSxZQUFZZ0QsS0FBS29CLE1BQU0sS0FBSztJQUNqRCxNQUFNUyxjQUFjN0IsS0FBS29CLE1BQU0sR0FBRzdELFdBQVlJLFlBQVlxQyxLQUFLb0IsTUFBTSxLQUFLO0lBRTFFLHFCQUNFLDZCQUFDVTtRQUNDbkYsV0FBVztZQUNUb0Ysc0JBQWM7WUFDZHpGO1lBQ0FLO1lBQ0FnRixpQkFBaUIsQ0FBQyxFQUFFckYsVUFBVSxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUVBLFVBQVUsY0FBYyxDQUFDO1NBQzFFLENBQ0UwRixNQUFNLENBQUNDLFNBQ1BDLElBQUksQ0FBQztRQUNSQyxJQUFJLENBQUMsTUFBTSxFQUFFM0UsS0FBSzRFLE9BQU8sQ0FBQyxPQUFPLE1BQU0sQ0FBQztPQUV2Q25DLDJCQUNDLDZCQUFDNkI7UUFBSW5GLFdBQVcsQ0FBQyxFQUFFTCxVQUFVLFlBQVksQ0FBQztxQkFDeEMsNkJBQUMrRixjQUFLO1FBQUNDLFNBQVN2QztRQUFjRSxXQUFXQTt1QkFHN0MsNkJBQUNzQztRQUFPNUYsV0FBVyxDQUFDLEVBQUVMLFVBQVUsUUFBUSxDQUFDO3FCQUN2Qyw2QkFBQ3dGO1FBQUluRixXQUFXLENBQUMsRUFBRUwsVUFBVSxhQUFhLENBQUM7cUJBQ3pDLDZCQUFDd0Y7UUFBSW5GLFdBQVcsQ0FBQyxFQUFFTCxVQUFVLGdCQUFnQixDQUFDO3FCQUM1Qyw2QkFBQ2tHO1FBQUc3RixXQUFXLENBQUMsRUFBRUwsVUFBVSxPQUFPLENBQUM7T0FBR21HLElBQUFBLDhCQUFjLEVBQUMzRSxTQUFTckIsTUFBTXVDLFFBQ3BFMkMsa0JBQWtCTixrQkFBa0IsbUJBQ25DLDZCQUFDcUIsb0JBQVM7UUFBQ0MsT0FBT3RCO1FBQWlCdUIsYUFBQUE7U0FHdEM1QyxLQUFLb0IsTUFBTSxHQUFHLG1CQUNiLDZCQUFDeUI7UUFBR2xHLFdBQVcsQ0FBQyxFQUFFTCxVQUFVLGdCQUFnQixDQUFDO3FCQUMzQyw2QkFBQ3dHLDBCQUNDLDZCQUFDQztRQUNDcEcsV0FBVyxDQUFDLEVBQUVMLFVBQVUsZUFBZSxDQUFDO1FBQ3hDMEcsU0FBUyxJQUFNakMsa0JBQWtCO1FBQ2pDTCxNQUFLO09BRUp6QixFQUFFLGdDQUdQLDZCQUFDNkQsMEJBQ0MsNkJBQUNDO1FBQ0NwRyxXQUFXLENBQUMsRUFBRUwsVUFBVSxlQUFlLENBQUM7UUFDeEMwRyxTQUFTLElBQU1qQyxrQkFBa0I7UUFDakNMLE1BQUs7T0FFSnpCLEVBQUUsOEJBTWIsNkJBQUNnRSx5QkFBZ0I7UUFDZnRHLFdBQVcsQ0FBQyxrQkFBa0IsRUFBRWEsS0FBSzRFLE9BQU8sQ0FBQyxPQUFPLE1BQU0sQ0FBQztRQUMzRHRGLGFBQWFBO1FBQ2JVLE1BQU1BO1FBQ05xQyxPQUFPQTt1QkFJWCw2QkFBQ3FELGdDQUFrQjtRQUFDQyxZQUFZdEQ7UUFBT3hDLFdBQVdBO1FBQVdHLE1BQU1BO1FBQ2xFLEFBQUN3QyxDQUFBQSxLQUFLb0IsTUFBTSxHQUFHLEtBQU0sQ0FBQ2xCLFNBQVUwQixDQUFBQSxnQkFBZ0JDLFdBQVUsQ0FBRSxtQkFDM0QsNkJBQUN1QiwwQkFBaUI7UUFDaEJ6RyxXQUFXLENBQUMsRUFBRUwsVUFBVSxnQkFBZ0IsQ0FBQztRQUN6QytHLEtBQUtyRCxLQUFLc0QsR0FBRyxDQUFDLENBQUM5QixNQUFRQSxJQUFJVyxFQUFFO1FBQzdCb0IsV0FBVyxDQUFDLEVBQUUxQyxhQUFhLEVBQUVDLFdBQVcsRUFBRSxHQUFLRixRQUFRQyxlQUFlQztPQUVyRWQsS0FBS3NELEdBQUcsQ0FBQyxDQUFDOUIsS0FBS2dDLGtCQUNkLDZCQUFDQyw4QkFBcUI7WUFBQ0MsVUFBVTFHLFlBQVksQ0FBQ0Q7WUFBWW9GLElBQUlYLElBQUlXLEVBQUU7WUFBRXdCLEtBQUtuQyxJQUFJVyxFQUFFO1dBQzlFLENBQUN5QiwyQ0FDQSw2QkFBQ0Msa0JBQVE7Z0JBQ04sR0FBR0QsMEJBQTBCO2dCQUM5QjNGLGdCQUFnQkE7Z0JBQ2hCb0MsUUFBUUE7Z0JBQ1JJLGNBQWNBO2dCQUNkeEQsWUFBWUE7Z0JBQ1pDLFFBQVFBO2dCQUNSQyxhQUFhQTtnQkFDYmdFLFlBQVlBO2dCQUNaL0QsV0FBV0E7Z0JBQ1hMLFlBQVlBO2dCQUNaZ0IsUUFBUUE7Z0JBQ1I2QyxTQUFTQTtnQkFDVHBELE1BQU1BO2dCQUNORSxhQUFhQTtnQkFDYlYsVUFBVUE7Z0JBQ1YyRCxXQUFXQTtnQkFDWGEsS0FBS0E7Z0JBQ0xzQyxVQUFVOUQsS0FBS29CLE1BQU07Z0JBQ3JCZCxVQUFVa0Q7Z0JBQ1Z2QyxhQUFhQTtrQkFLcEIsQ0FBQ2YsdUJBQ0EsNkJBQUM2RCxjQUFLLENBQUNDLFFBQVEsUUFDWnBDLDhCQUNDLDZCQUFDcUMsZUFBTSxRQUNKaEYsRUFBRSx5QkFBeUI7UUFBRW5CLE9BQU8yRSxJQUFBQSw4QkFBYyxFQUFDMUUsT0FBTzJCLE1BQU0sRUFBRVY7SUFBTSxLQUc1RTZDLDZCQUNDLDZCQUFDb0MsZUFBTTtRQUFDdkQsTUFBSztPQUNWekIsRUFBRSw4QkFBOEI7UUFDL0IwRCxPQUFPcEY7UUFDUE8sT0FDRTJFLElBQUFBLDhCQUFjLEVBQUNsRixVQUFVUSxPQUFPMkIsTUFBTSxHQUFHM0IsT0FBT0MsUUFBUSxFQUFFZ0IsU0FDMURDLEVBQUUxQixVQUFVLElBQUksZ0JBQWdCO0lBQ3BDLE9BT1gsQ0FBQ1AsWUFBWSxDQUFDbUUsNEJBQ2IsNkJBQUMrQyxlQUFNO1FBQ0xDLGFBQVk7UUFDWnhILFdBQVcsQ0FBQyxFQUFFTCxVQUFVLFNBQVMsQ0FBQztRQUNsQzhILE1BQUs7UUFDTEMsY0FBYTtRQUNiQyxXQUFVO1FBQ1Z0QixTQUFTLElBQU0zQyxPQUFPUixTQUFTO09BRTlCWixFQUFFLFlBQVk7UUFBRW5CLE9BQU8yRSxJQUFBQSw4QkFBYyxFQUFDMUUsT0FBT0MsUUFBUSxFQUFFZ0I7SUFBTTtBQUt4RTtNQUVBLFdBQWV1RixJQUFBQSxzQkFBYSxFQUFDaEkifQ==